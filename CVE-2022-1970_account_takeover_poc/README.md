# CVE-2022-1970:

keycloak 18.0.0: open redirect in auth endpoint via the redirect_uri parameter.

An account takeover can occur if the application uses OAuth2.

## PoC:

- Initiate Authentication Request:

The client initiates an authentication request to Keycloak with a specified "redirect_uri" parameter.

- Open Redirect Vulnerability:

Keycloak fails to properly validate the "redirect_uri" parameter, potentially allowing an open redirect during authentication.

- Authentication and Redirect:

If the credentials are valid, Keycloak attempts to redirect the user to the specified "redirect_uri" with appended "session_state" and "code" parameters in the hash portion of the URL.

- JavaScript Code Execution:

On the client side, a JavaScript code is implemented to extract the "session_state" and "code" parameters from the hash in the URL.

![image](https://github.com/j4k0m/godkiller/assets/48088579/eda5c9ab-0b08-4b54-8a91-b80ab601d216)


- Send GET Request to Server:

The JavaScript code constructs a new GET request to the web server, including the extracted "session_state" and "code" parameters.

- Retrieve Parameters on the Server:

The server receives the GET request and retrieves the "session_state" and "code" parameters from the request.

![image](https://github.com/j4k0m/godkiller/assets/48088579/7e8076c9-4e73-4718-9a23-034cfb413e15)


- Access Token Generation:

With the obtained "session_state" and "code" parameters, the server can now proceed to generate the access token using the appropriate Keycloak APIs or processes.

![image](https://github.com/j4k0m/godkiller/assets/48088579/2b267315-c41a-44b9-a061-72c8d6ae5e0b)

